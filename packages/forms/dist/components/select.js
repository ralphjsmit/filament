var Y=Math.min,P=Math.max,G=Math.round;var S=i=>({x:i,y:i}),qt={left:"right",right:"left",bottom:"top",top:"bottom"},Yt={start:"end",end:"start"};function at(i,t,e){return P(i,Y(t,e))}function Q(i,t){return typeof i=="function"?i(t):i}function M(i){return i.split("-")[0]}function X(i){return i.split("-")[1]}function ft(i){return i==="x"?"y":"x"}function ht(i){return i==="y"?"height":"width"}function N(i){return["top","bottom"].includes(M(i))?"y":"x"}function dt(i){return ft(N(i))}function xt(i,t,e){e===void 0&&(e=!1);let s=X(i),n=dt(i),o=ht(n),r=n==="x"?s===(e?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(r=q(r)),[r,q(r)]}function vt(i){let t=q(i);return[it(i),t,it(t)]}function it(i){return i.replace(/start|end/g,t=>Yt[t])}function Gt(i,t,e){let s=["left","right"],n=["right","left"],o=["top","bottom"],r=["bottom","top"];switch(i){case"top":case"bottom":return e?t?n:s:t?s:n;case"left":case"right":return t?o:r;default:return[]}}function Ot(i,t,e,s){let n=X(i),o=Gt(M(i),e==="start",s);return n&&(o=o.map(r=>r+"-"+n),t&&(o=o.concat(o.map(it)))),o}function q(i){return i.replace(/left|right|bottom|top/g,t=>qt[t])}function Qt(i){return{top:0,right:0,bottom:0,left:0,...i}}function At(i){return typeof i!="number"?Qt(i):{top:i,right:i,bottom:i,left:i}}function V(i){let{x:t,y:e,width:s,height:n}=i;return{width:s,height:n,top:e,left:t,right:t+s,bottom:e+n,x:t,y:e}}function Lt(i,t,e){let{reference:s,floating:n}=i,o=N(t),r=dt(t),l=ht(r),c=M(t),a=o==="y",h=s.x+s.width/2-n.width/2,f=s.y+s.height/2-n.height/2,u=s[l]/2-n[l]/2,d;switch(c){case"top":d={x:h,y:s.y-n.height};break;case"bottom":d={x:h,y:s.y+s.height};break;case"right":d={x:s.x+s.width,y:f};break;case"left":d={x:s.x-n.width,y:f};break;default:d={x:s.x,y:s.y}}switch(X(t)){case"start":d[r]-=u*(e&&a?-1:1);break;case"end":d[r]+=u*(e&&a?-1:1);break}return d}var St=async(i,t,e)=>{let{placement:s="bottom",strategy:n="absolute",middleware:o=[],platform:r}=e,l=o.filter(Boolean),c=await(r.isRTL==null?void 0:r.isRTL(t)),a=await r.getElementRects({reference:i,floating:t,strategy:n}),{x:h,y:f}=Lt(a,s,c),u=s,d={},p=0;for(let m=0;m<l.length;m++){let{name:g,fn:b}=l[m],{x:y,y:x,data:v,reset:w}=await b({x:h,y:f,initialPlacement:s,placement:u,strategy:n,middlewareData:d,rects:a,platform:r,elements:{reference:i,floating:t}});h=y??h,f=x??f,d={...d,[g]:{...d[g],...v}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(u=w.placement),w.rects&&(a=w.rects===!0?await r.getElementRects({reference:i,floating:t,strategy:n}):w.rects),{x:h,y:f}=Lt(a,u,c)),m=-1)}return{x:h,y:f,placement:u,strategy:n,middlewareData:d}};async function ut(i,t){var e;t===void 0&&(t={});let{x:s,y:n,platform:o,rects:r,elements:l,strategy:c}=i,{boundary:a="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:u=!1,padding:d=0}=Q(t,i),p=At(d),g=l[u?f==="floating"?"reference":"floating":f],b=V(await o.getClippingRect({element:(e=await(o.isElement==null?void 0:o.isElement(g)))==null||e?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:a,rootBoundary:h,strategy:c})),y=f==="floating"?{x:s,y:n,width:r.floating.width,height:r.floating.height}:r.reference,x=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),v=await(o.isElement==null?void 0:o.isElement(x))?await(o.getScale==null?void 0:o.getScale(x))||{x:1,y:1}:{x:1,y:1},w=V(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:x,strategy:c}):y);return{top:(b.top-w.top+p.top)/v.y,bottom:(w.bottom-b.bottom+p.bottom)/v.y,left:(b.left-w.left+p.left)/v.x,right:(w.right-b.right+p.right)/v.x}}var Ct=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(t){var e,s;let{placement:n,middlewareData:o,rects:r,initialPlacement:l,platform:c,elements:a}=t,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:u,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Q(i,t);if((e=o.arrow)!=null&&e.alignmentOffset)return{};let b=M(n),y=N(l),x=M(l)===l,v=await(c.isRTL==null?void 0:c.isRTL(a.floating)),w=u||(x||!m?[q(l)]:vt(l)),z=p!=="none";!u&&z&&w.push(...Ot(l,m,p,v));let _=[l,...w],W=await ut(t,g),I=[],B=((s=o.flip)==null?void 0:s.overflows)||[];if(h&&I.push(W[b]),f){let H=xt(n,r,v);I.push(W[H[0]],W[H[1]])}if(B=[...B,{placement:n,overflows:I}],!I.every(H=>H<=0)){var et,bt;let H=(((et=o.flip)==null?void 0:et.index)||0)+1,ct=_[H];if(ct){var yt;let k=f==="alignment"?y!==N(ct):!1,D=((yt=B[0])==null?void 0:yt.overflows[0])>0;if(!k||D)return{data:{index:H,overflows:B},reset:{placement:ct}}}let J=(bt=B.filter(k=>k.overflows[0]<=0).sort((k,D)=>k.overflows[1]-D.overflows[1])[0])==null?void 0:bt.placement;if(!J)switch(d){case"bestFit":{var wt;let k=(wt=B.filter(D=>{if(z){let T=N(D.placement);return T===y||T==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(T=>T>0).reduce((T,Jt)=>T+Jt,0)]).sort((D,T)=>D[1]-T[1])[0])==null?void 0:wt[0];k&&(J=k);break}case"initialPlacement":J=l;break}if(n!==J)return{reset:{placement:J}}}return{}}}};async function Xt(i,t){let{placement:e,platform:s,elements:n}=i,o=await(s.isRTL==null?void 0:s.isRTL(n.floating)),r=M(e),l=X(e),c=N(e)==="y",a=["left","top"].includes(r)?-1:1,h=o&&c?-1:1,f=Q(t,i),{mainAxis:u,crossAxis:d,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof p=="number"&&(d=l==="end"?p*-1:p),c?{x:d*h,y:u*a}:{x:u*a,y:d*h}}var Dt=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(t){var e,s;let{x:n,y:o,placement:r,middlewareData:l}=t,c=await Xt(t,i);return r===((e=l.offset)==null?void 0:e.placement)&&(s=l.arrow)!=null&&s.alignmentOffset?{}:{x:n+c.x,y:o+c.y,data:{...c,placement:r}}}}},Et=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(t){let{x:e,y:s,placement:n}=t,{mainAxis:o=!0,crossAxis:r=!1,limiter:l={fn:g=>{let{x:b,y}=g;return{x:b,y}}},...c}=Q(i,t),a={x:e,y:s},h=await ut(t,c),f=N(M(n)),u=ft(f),d=a[u],p=a[f];if(o){let g=u==="y"?"top":"left",b=u==="y"?"bottom":"right",y=d+h[g],x=d-h[b];d=at(y,d,x)}if(r){let g=f==="y"?"top":"left",b=f==="y"?"bottom":"right",y=p+h[g],x=p-h[b];p=at(y,p,x)}let m=l.fn({...t,[u]:d,[f]:p});return{...m,data:{x:m.x-e,y:m.y-s,enabled:{[u]:o,[f]:r}}}}}};function nt(){return typeof window<"u"}function j(i){return It(i)?(i.nodeName||"").toLowerCase():"#document"}function O(i){var t;return(i==null||(t=i.ownerDocument)==null?void 0:t.defaultView)||window}function E(i){var t;return(t=(It(i)?i.ownerDocument:i.document)||window.document)==null?void 0:t.documentElement}function It(i){return nt()?i instanceof Node||i instanceof O(i).Node:!1}function A(i){return nt()?i instanceof Element||i instanceof O(i).Element:!1}function C(i){return nt()?i instanceof HTMLElement||i instanceof O(i).HTMLElement:!1}function Rt(i){return!nt()||typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof O(i).ShadowRoot}function $(i){let{overflow:t,overflowX:e,overflowY:s,display:n}=L(i);return/auto|scroll|overlay|hidden|clip/.test(t+s+e)&&!["inline","contents"].includes(n)}function kt(i){return["table","td","th"].includes(j(i))}function K(i){return[":popover-open",":modal"].some(t=>{try{return i.matches(t)}catch{return!1}})}function ot(i){let t=rt(),e=A(i)?L(i):i;return["transform","translate","scale","rotate","perspective"].some(s=>e[s]?e[s]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(e.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(e.contain||"").includes(s))}function Tt(i){let t=R(i);for(;C(t)&&!F(t);){if(ot(t))return t;if(K(t))return null;t=R(t)}return null}function rt(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function F(i){return["html","body","#document"].includes(j(i))}function L(i){return O(i).getComputedStyle(i)}function Z(i){return A(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.scrollX,scrollTop:i.scrollY}}function R(i){if(j(i)==="html")return i;let t=i.assignedSlot||i.parentNode||Rt(i)&&i.host||E(i);return Rt(t)?t.host:t}function Pt(i){let t=R(i);return F(t)?i.ownerDocument?i.ownerDocument.body:i.body:C(t)&&$(t)?t:Pt(t)}function st(i,t,e){var s;t===void 0&&(t=[]),e===void 0&&(e=!0);let n=Pt(i),o=n===((s=i.ownerDocument)==null?void 0:s.body),r=O(n);if(o){let l=lt(r);return t.concat(r,r.visualViewport||[],$(n)?n:[],l&&e?st(l):[])}return t.concat(n,st(n,[],e))}function lt(i){return i.parent&&Object.getPrototypeOf(i.parent)?i.frameElement:null}function Bt(i){let t=L(i),e=parseFloat(t.width)||0,s=parseFloat(t.height)||0,n=C(i),o=n?i.offsetWidth:e,r=n?i.offsetHeight:s,l=G(e)!==o||G(s)!==r;return l&&(e=o,s=r),{width:e,height:s,$:l}}function Ht(i){return A(i)?i:i.contextElement}function U(i){let t=Ht(i);if(!C(t))return S(1);let e=t.getBoundingClientRect(),{width:s,height:n,$:o}=Bt(t),r=(o?G(e.width):e.width)/s,l=(o?G(e.height):e.height)/n;return(!r||!Number.isFinite(r))&&(r=1),(!l||!Number.isFinite(l))&&(l=1),{x:r,y:l}}var Kt=S(0);function Vt(i){let t=O(i);return!rt()||!t.visualViewport?Kt:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Zt(i,t,e){return t===void 0&&(t=!1),!e||t&&e!==O(i)?!1:t}function tt(i,t,e,s){t===void 0&&(t=!1),e===void 0&&(e=!1);let n=i.getBoundingClientRect(),o=Ht(i),r=S(1);t&&(s?A(s)&&(r=U(s)):r=U(i));let l=Zt(o,e,s)?Vt(o):S(0),c=(n.left+l.x)/r.x,a=(n.top+l.y)/r.y,h=n.width/r.x,f=n.height/r.y;if(o){let u=O(o),d=s&&A(s)?O(s):s,p=u,m=lt(p);for(;m&&s&&d!==p;){let g=U(m),b=m.getBoundingClientRect(),y=L(m),x=b.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,v=b.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;c*=g.x,a*=g.y,h*=g.x,f*=g.y,c+=x,a+=v,p=O(m),m=lt(p)}}return V({width:h,height:f,x:c,y:a})}function mt(i,t){let e=Z(i).scrollLeft;return t?t.left+e:tt(E(i)).left+e}function jt(i,t,e){e===void 0&&(e=!1);let s=i.getBoundingClientRect(),n=s.left+t.scrollLeft-(e?0:mt(i,s)),o=s.top+t.scrollTop;return{x:n,y:o}}function te(i){let{elements:t,rect:e,offsetParent:s,strategy:n}=i,o=n==="fixed",r=E(s),l=t?K(t.floating):!1;if(s===r||l&&o)return e;let c={scrollLeft:0,scrollTop:0},a=S(1),h=S(0),f=C(s);if((f||!f&&!o)&&((j(s)!=="body"||$(r))&&(c=Z(s)),C(s))){let d=tt(s);a=U(s),h.x=d.x+s.clientLeft,h.y=d.y+s.clientTop}let u=r&&!f&&!o?jt(r,c,!0):S(0);return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-c.scrollLeft*a.x+h.x+u.x,y:e.y*a.y-c.scrollTop*a.y+h.y+u.y}}function ee(i){return Array.from(i.getClientRects())}function ie(i){let t=E(i),e=Z(i),s=i.ownerDocument.body,n=P(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),o=P(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight),r=-e.scrollLeft+mt(i),l=-e.scrollTop;return L(s).direction==="rtl"&&(r+=P(t.clientWidth,s.clientWidth)-n),{width:n,height:o,x:r,y:l}}function se(i,t){let e=O(i),s=E(i),n=e.visualViewport,o=s.clientWidth,r=s.clientHeight,l=0,c=0;if(n){o=n.width,r=n.height;let a=rt();(!a||a&&t==="fixed")&&(l=n.offsetLeft,c=n.offsetTop)}return{width:o,height:r,x:l,y:c}}function ne(i,t){let e=tt(i,!0,t==="fixed"),s=e.top+i.clientTop,n=e.left+i.clientLeft,o=C(i)?U(i):S(1),r=i.clientWidth*o.x,l=i.clientHeight*o.y,c=n*o.x,a=s*o.y;return{width:r,height:l,x:c,y:a}}function Mt(i,t,e){let s;if(t==="viewport")s=se(i,e);else if(t==="document")s=ie(E(i));else if(A(t))s=ne(t,e);else{let n=Vt(i);s={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return V(s)}function Ft(i,t){let e=R(i);return e===t||!A(e)||F(e)?!1:L(e).position==="fixed"||Ft(e,t)}function oe(i,t){let e=t.get(i);if(e)return e;let s=st(i,[],!1).filter(l=>A(l)&&j(l)!=="body"),n=null,o=L(i).position==="fixed",r=o?R(i):i;for(;A(r)&&!F(r);){let l=L(r),c=ot(r);!c&&l.position==="fixed"&&(n=null),(o?!c&&!n:!c&&l.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||$(r)&&!c&&Ft(i,r))?s=s.filter(h=>h!==r):n=l,r=R(r)}return t.set(i,s),s}function re(i){let{element:t,boundary:e,rootBoundary:s,strategy:n}=i,r=[...e==="clippingAncestors"?K(t)?[]:oe(t,this._c):[].concat(e),s],l=r[0],c=r.reduce((a,h)=>{let f=Mt(t,h,n);return a.top=P(f.top,a.top),a.right=Y(f.right,a.right),a.bottom=Y(f.bottom,a.bottom),a.left=P(f.left,a.left),a},Mt(t,l,n));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function le(i){let{width:t,height:e}=Bt(i);return{width:t,height:e}}function ce(i,t,e){let s=C(t),n=E(t),o=e==="fixed",r=tt(i,!0,o,t),l={scrollLeft:0,scrollTop:0},c=S(0);function a(){c.x=mt(n)}if(s||!s&&!o)if((j(t)!=="body"||$(n))&&(l=Z(t)),s){let d=tt(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else n&&a();o&&!s&&n&&a();let h=n&&!s&&!o?jt(n,l):S(0),f=r.left+l.scrollLeft-c.x-h.x,u=r.top+l.scrollTop-c.y-h.y;return{x:f,y:u,width:r.width,height:r.height}}function pt(i){return L(i).position==="static"}function Nt(i,t){if(!C(i)||L(i).position==="fixed")return null;if(t)return t(i);let e=i.offsetParent;return E(i)===e&&(e=e.ownerDocument.body),e}function zt(i,t){let e=O(i);if(K(i))return e;if(!C(i)){let n=R(i);for(;n&&!F(n);){if(A(n)&&!pt(n))return n;n=R(n)}return e}let s=Nt(i,t);for(;s&&kt(s)&&pt(s);)s=Nt(s,t);return s&&F(s)&&pt(s)&&!ot(s)?e:s||Tt(i)||e}var ae=async function(i){let t=this.getOffsetParent||zt,e=this.getDimensions,s=await e(i.floating);return{reference:ce(i.reference,await t(i.floating),i.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function fe(i){return L(i).direction==="rtl"}var he={convertOffsetParentRelativeRectToViewportRelativeRect:te,getDocumentElement:E,getClippingRect:re,getOffsetParent:zt,getElementRects:ae,getClientRects:ee,getDimensions:le,getScale:U,isElement:A,isRTL:fe};var Wt=Dt;var $t=Et,Ut=Ct;var _t=(i,t,e)=>{let s=new Map,n={platform:he,...e},o={...n.platform,_c:s};return St(i,t,{...n,platform:o})};function de({canSelectPlaceholder:i,isHtmlAllowed:t,getOptionLabelUsing:e,getOptionLabelsUsing:s,getOptionsUsing:n,getSearchResultsUsing:o,isAutofocused:r,isDisabled:l,isMultiple:c,isSearchable:a,hasDynamicOptions:h,hasDynamicSearchResults:f,livewireId:u,loadingMessage:d,maxItems:p,maxItemsMessage:m,noSearchResultsMessage:g,options:b,optionsLimit:y,placeholder:x,position:v,searchDebounce:w,searchingMessage:z,searchPrompt:_,searchableOptionFields:W,state:I,statePath:B}){return{state:I,select:null,init(){this.select=new gt({element:this.$refs.select,options:b,placeholder:x,state:this.state,canSelectPlaceholder:i,isHtmlAllowed:t,isAutofocused:r,isDisabled:l,isMultiple:c,isSearchable:a,getOptionLabelUsing:e,getOptionLabelsUsing:s,getOptionsUsing:n,getSearchResultsUsing:o,hasDynamicOptions:h,hasDynamicSearchResults:f,searchPrompt:_,searchDebounce:w,loadingMessage:d,searchingMessage:z,noSearchResultsMessage:g,maxItems:p,maxItemsMessage:m,optionsLimit:y,onStateChange:et=>{this.state=et}})}}}var gt=class{constructor({element:t,options:e,placeholder:s,state:n,canSelectPlaceholder:o=!0,isHtmlAllowed:r=!1,isAutofocused:l=!1,isDisabled:c=!1,isMultiple:a=!1,isSearchable:h=!1,getOptionLabelUsing:f=null,getOptionLabelsUsing:u=null,getOptionsUsing:d=null,getSearchResultsUsing:p=null,hasDynamicOptions:m=!1,hasDynamicSearchResults:g=!0,searchPrompt:b="Search...",searchDebounce:y=1e3,loadingMessage:x="Loading...",searchingMessage:v="Searching...",noSearchResultsMessage:w="No results found",maxItems:z=null,maxItemsMessage:_="Maximum number of items selected",optionsLimit:W=null,onStateChange:I=()=>{}}){this.element=t,this.options=e,this.originalOptions=JSON.parse(JSON.stringify(e)),this.placeholder=s,this.state=n,this.canSelectPlaceholder=o,this.isHtmlAllowed=r,this.isAutofocused=l,this.isDisabled=c,this.isMultiple=a,this.isSearchable=h,this.getOptionLabelUsing=f,this.getOptionLabelsUsing=u,this.getOptionsUsing=d,this.getSearchResultsUsing=p,this.hasDynamicOptions=m,this.hasDynamicSearchResults=g,this.searchPrompt=b,this.searchDebounce=y,this.loadingMessage=x,this.searchingMessage=v,this.noSearchResultsMessage=w,this.maxItems=z,this.maxItemsMessage=_,this.optionsLimit=W,this.onStateChange=I,this.isOpen=!1,this.selectedIndex=-1,this.searchQuery="",this.searchTimeout=null,this.render(),this.setupEventListeners(),this.isAutofocused&&this.selectButton.focus()}render(){this.container=document.createElement("div"),this.container.className="fi-select-container",this.container.setAttribute("aria-haspopup","listbox"),this.selectButton=document.createElement("button"),this.selectButton.className="fi-select-button",this.selectButton.type="button",this.selectButton.setAttribute("aria-expanded","false"),this.selectButton.setAttribute("aria-labelledby","select-label"),this.selectedDisplay=document.createElement("span"),this.selectedDisplay.className="fi-select-value",this.updateSelectedDisplay(),this.selectButton.appendChild(this.selectedDisplay),this.dropdown=document.createElement("div"),this.dropdown.className="fi-select-dropdown",this.dropdown.setAttribute("role","listbox"),this.dropdown.setAttribute("tabindex","-1"),this.dropdown.style.display="none",this.isSearchable&&(this.searchContainer=document.createElement("div"),this.searchContainer.className="fi-select-search-container",this.searchInput=document.createElement("input"),this.searchInput.className="fi-select-search-input",this.searchInput.type="text",this.searchInput.placeholder=this.searchPrompt,this.searchInput.setAttribute("aria-label","Search"),this.searchContainer.appendChild(this.searchInput),this.dropdown.appendChild(this.searchContainer),this.searchInput.addEventListener("input",t=>{this.isDisabled||this.handleSearch(t)}),this.searchInput.addEventListener("keydown",t=>{if(!this.isDisabled){if(t.key==="Tab"){t.preventDefault();let e=this.getVisibleOptions();if(e.length===0)return;t.shiftKey?this.selectedIndex=e.length-1:this.selectedIndex=0,e.forEach(s=>{s.classList.remove("fi-select-option-focused")}),e[this.selectedIndex].classList.add("fi-select-option-focused"),e[this.selectedIndex].focus()}else if(t.key==="ArrowDown"){if(t.preventDefault(),t.stopPropagation(),this.getVisibleOptions().length===0)return;this.selectedIndex=-1,this.searchInput.blur(),this.focusNextOption()}else if(t.key==="ArrowUp"){if(t.preventDefault(),t.stopPropagation(),this.getVisibleOptions().length===0)return;this.selectedIndex=0,this.searchInput.blur(),this.focusPreviousOption()}}})),this.optionsList=document.createElement("ul"),this.optionsList.className="fi-select-options-list",this.renderOptions(),this.dropdown.appendChild(this.optionsList),this.container.appendChild(this.selectButton),this.container.appendChild(this.dropdown),this.element.appendChild(this.container),this.applyDisabledState()}renderOptions(){this.optionsList.innerHTML="";let t=0;if(Array.isArray(this.options)){let e=this.options,s=0;this.options.forEach(o=>{o.options&&Array.isArray(o.options)?s+=o.options.length:s++});let n=0;for(let o of e){if(this.optionsLimit&&n>=this.optionsLimit)break;if(o.options&&Array.isArray(o.options)){let r=o.options;if(this.isMultiple&&Array.isArray(this.state)&&this.state.length>0&&(r=o.options.filter(l=>!this.state.includes(l.value))),r.length>0){if(this.optionsLimit){let l=this.optionsLimit-n;l<r.length&&(r=r.slice(0,l))}this.renderOptionGroup(o.label,r),n+=r.length,t+=r.length}}else{if(this.isMultiple&&Array.isArray(this.state)&&this.state.includes(o.value))continue;let r=this.createOptionElement(o.value,o);this.optionsList.appendChild(r),n++,t++}}}else if(typeof this.options=="object"&&this.options!==null){let e=0;for(let[s,n]of Object.entries(this.options)){if(this.optionsLimit&&e>=this.optionsLimit)break;if(typeof n=="object"&&!Array.isArray(n)&&n!==null){let o=document.createElement("li");o.className="fi-select-option-group",o.textContent=s;let r=document.createElement("ul");r.className="fi-select-option-group-list";let l=!1,c=0;for(let[a,h]of Object.entries(n)){if(this.optionsLimit&&e+c>=this.optionsLimit)break;if(this.isMultiple&&Array.isArray(this.state)&&this.state.includes(a))continue;let f=this.createOptionElement(a,h);r.appendChild(f),l=!0,c++}l&&(o.appendChild(r),this.optionsList.appendChild(o),e+=c,t+=c)}else{if(this.isMultiple&&Array.isArray(this.state)&&this.state.includes(s))continue;let o=this.createOptionElement(s,n);this.optionsList.appendChild(o),e++,t++}}}this.isMultiple&&t===0&&this.isOpen&&(!this.isSearchable||!this.searchQuery)&&this.closeDropdown()}renderOptionGroup(t,e){let s=document.createElement("li");s.className="fi-select-option-group",s.textContent=t;let n=document.createElement("ul");n.className="fi-select-option-group-list",e.forEach(o=>{let r=this.createOptionElement(o.value,o);n.appendChild(r)}),s.appendChild(n),this.optionsList.appendChild(s)}createOptionElement(t,e){let s=t,n=e,o=!1;typeof e=="object"&&e!==null&&"label"in e&&"value"in e&&(s=e.value,n=e.label,o=e.isDisabled||!1);let r=document.createElement("li");r.className="fi-select-option",o?r.classList.add("fi-select-option-disabled"):r.classList.add("fi-select-option-enabled"),r.setAttribute("role","option"),r.setAttribute("data-value",s),r.setAttribute("tabindex","0"),o&&r.setAttribute("aria-disabled","true");let l=this.isMultiple?Array.isArray(this.state)&&this.state.includes(s):this.state===s;if(r.setAttribute("aria-selected",l?"true":"false"),l){r.classList.add("fi-select-option-selected");let c=document.createElement("span");c.className="fi-select-option-checkmark",c.innerHTML='<svg class="fi-select-option-checkmark-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>',r.appendChild(c)}if(this.isHtmlAllowed){let c=document.createElement("span");c.innerHTML=n,r.appendChild(c)}else r.textContent=n;return o||r.addEventListener("click",c=>{c.preventDefault(),c.stopPropagation(),this.selectOption(s),this.isMultiple&&(this.isSearchable&&this.searchInput?setTimeout(()=>{this.searchInput.focus()},0):setTimeout(()=>{r.focus()},0))}),r}async updateSelectedDisplay(){if(this.isMultiple)if(this.selectedDisplay.innerHTML="",Array.isArray(this.state)&&this.state.length>0){let t=this.getSelectedOptionLabels();if(t.length<this.state.length&&this.getOptionLabelsUsing)try{let s=this.state.filter((n,o)=>!t[o]);if(s.length>0){let n=await this.getOptionLabelsUsing(s);t=this.state.map(o=>{let r=this.getSelectedOptionLabel(o);return r||n[o]||o})}}catch(s){console.error("Error fetching option labels:",s)}let e=document.createElement("div");e.className="fi-select-badges",t.forEach((s,n)=>{let o=document.createElement("span");o.className="fi-select-badge";let r=document.createElement("span");r.className="fi-select-badge-label",this.isHtmlAllowed?r.innerHTML=s:r.textContent=s,o.appendChild(r);let l=document.createElement("button");l.type="button",l.className="fi-select-badge-remove",l.innerHTML='<svg class="fi-select-badge-remove-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>',l.setAttribute("aria-label","Remove "+(this.isHtmlAllowed?s.replace(/<[^>]*>/g,""):s));let c=Array.isArray(this.state)?this.state[n]:null;l.addEventListener("click",a=>{a.stopPropagation(),c!==null&&this.selectOption(c)}),l.addEventListener("keydown",a=>{(a.key===" "||a.key==="Enter")&&(a.preventDefault(),a.stopPropagation(),c!==null&&this.selectOption(c))}),o.appendChild(l),e.appendChild(o)}),this.selectedDisplay.appendChild(e)}else this.selectedDisplay.textContent=this.placeholder||"Select options";else if(this.state===null||this.state==="")this.selectedDisplay.textContent=this.placeholder||"Select an option";else{let t=this.getSelectedOptionLabel(this.state);if(!t&&this.getOptionLabelUsing)try{t=await this.getOptionLabelUsing(this.state)}catch(s){console.error("Error fetching option label:",s),t=this.state}else t||(t=this.state);this.selectedDisplay.innerHTML="";let e=document.createElement("span");if(e.className="fi-select-single-label",this.isHtmlAllowed?e.innerHTML=t:e.textContent=t,this.selectedDisplay.appendChild(e),this.canSelectPlaceholder){let s=document.createElement("button");s.type="button",s.className="fi-select-single-remove",s.innerHTML='<svg class="fi-select-single-remove-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>',s.setAttribute("aria-label","Clear selection"),s.addEventListener("click",n=>{n.stopPropagation(),this.selectOption("")}),s.addEventListener("keydown",n=>{(n.key===" "||n.key==="Enter")&&(n.preventDefault(),n.stopPropagation(),this.selectOption(""))}),this.selectedDisplay.appendChild(s)}}}getSelectedOptionLabel(t){let e="";if(Array.isArray(this.options)){for(let s of this.options)if(s.options&&Array.isArray(s.options)){for(let n of s.options)if(n.value===t){e=n.label;break}}else if(s.value===t){e=s.label;break}}else Object.entries(this.options).forEach(([s,n])=>{s===t&&typeof n!="object"&&(e=n)}),e||Object.entries(this.options).forEach(([s,n])=>{typeof n=="object"&&!Array.isArray(n)&&Object.entries(n).forEach(([o,r])=>{o===t&&(e=r)})});return e}setupEventListeners(){this.selectButton.addEventListener("click",()=>{this.toggleDropdown()}),document.addEventListener("click",t=>{!this.container.contains(t.target)&&this.isOpen&&this.closeDropdown()}),this.selectButton.addEventListener("keydown",t=>{if(!this.isDisabled)switch(t.key){case"ArrowDown":t.preventDefault(),t.stopPropagation(),this.isOpen?this.focusNextOption():this.openDropdown();break;case"ArrowUp":t.preventDefault(),t.stopPropagation(),this.isOpen?this.focusPreviousOption():this.openDropdown();break;case" ":if(t.preventDefault(),this.isOpen){if(this.selectedIndex>=0){let e=this.getVisibleOptions()[this.selectedIndex];e&&e.click()}}else this.openDropdown();break;case"Enter":break;case"Escape":this.isOpen&&(t.preventDefault(),this.closeDropdown());break;case"Tab":this.isOpen&&this.closeDropdown();break}}),this.dropdown.addEventListener("keydown",t=>{if(!this.isDisabled&&!(this.isSearchable&&document.activeElement===this.searchInput&&!["Tab","Escape"].includes(t.key)))switch(t.key){case"ArrowDown":t.preventDefault(),t.stopPropagation(),this.focusNextOption();break;case"ArrowUp":t.preventDefault(),t.stopPropagation(),this.focusPreviousOption();break;case" ":if(t.preventDefault(),this.selectedIndex>=0){let e=this.getVisibleOptions()[this.selectedIndex];e&&e.click()}break;case"Enter":break;case"Escape":t.preventDefault(),this.closeDropdown(),this.selectButton.focus();break;case"Tab":this.closeDropdown();break}})}toggleDropdown(){if(!this.isDisabled)if(this.isOpen)this.closeDropdown();else{if(this.isMultiple&&!this.isSearchable){let t=0;if(Array.isArray(this.options)){for(let e of this.options)if(e.options&&Array.isArray(e.options)){for(let s of e.options)if(!Array.isArray(this.state)||!this.state.includes(s.value)){t++;break}}else if(!Array.isArray(this.state)||!this.state.includes(e.value)){t++;break}}else if(typeof this.options=="object"&&this.options!==null){for(let[e,s]of Object.entries(this.options))if(typeof s=="object"&&!Array.isArray(s)&&s!==null){for(let[n,o]of Object.entries(s))if(!Array.isArray(this.state)||!this.state.includes(n)){t++;break}}else if(!Array.isArray(this.state)||!this.state.includes(e)){t++;break}}if(t===0)return}this.openDropdown()}}async openDropdown(){if(this.dropdown.style.display="block",this.dropdown.style.opacity="0",this.dropdown.style.position="absolute",this.selectButton.setAttribute("aria-expanded","true"),this.isOpen=!0,this.positionDropdown(),this.resizeListener||(this.resizeListener=()=>this.positionDropdown(),window.addEventListener("resize",this.resizeListener)),this.dropdown.style.opacity="1",this.hasDynamicOptions&&this.getOptionsUsing){this.showLoadingState(!1);try{let t=await this.getOptionsUsing();this.options=t,this.originalOptions=JSON.parse(JSON.stringify(t)),this.renderOptions()}catch(t){console.error("Error fetching options:",t),this.hideLoadingState()}}if(this.isSearchable&&this.searchInput)this.searchInput.value="",this.searchInput.focus(),this.searchQuery&&(this.searchQuery="",this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions());else{this.selectedIndex=-1;let t=this.getVisibleOptions();if(this.isMultiple){if(Array.isArray(this.state)&&this.state.length>0){for(let e=0;e<t.length;e++)if(this.state.includes(t[e].getAttribute("data-value"))){this.selectedIndex=e;break}}}else for(let e=0;e<t.length;e++)if(t[e].getAttribute("data-value")===this.state){this.selectedIndex=e;break}this.selectedIndex===-1&&t.length>0&&(this.selectedIndex=0),this.selectedIndex>=0&&(t[this.selectedIndex].classList.add("fi-select-option-focused"),t[this.selectedIndex].focus())}}positionDropdown(){_t(this.selectButton,this.dropdown,{placement:"bottom-start",middleware:[Wt(4),Ut(),$t({padding:5})]}).then(({x:t,y:e})=>{Object.assign(this.dropdown.style,{left:`${t}px`,top:`${e}px`,width:`${this.selectButton.offsetWidth}px`})})}closeDropdown(){this.dropdown.style.display="none",this.selectButton.setAttribute("aria-expanded","false"),this.isOpen=!1,this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null),this.getVisibleOptions().forEach(e=>{e.classList.remove("fi-select-option-focused")})}focusNextOption(){let t=this.getVisibleOptions();if(t.length!==0){if(this.selectedIndex>=0&&this.selectedIndex<t.length&&t[this.selectedIndex].classList.remove("fi-select-option-focused"),this.selectedIndex===t.length-1&&this.isSearchable&&this.searchInput){this.selectedIndex=-1,this.searchInput.focus();return}this.selectedIndex=(this.selectedIndex+1)%t.length,t[this.selectedIndex].classList.add("fi-select-option-focused"),t[this.selectedIndex].focus(),this.scrollOptionIntoView(t[this.selectedIndex])}}focusPreviousOption(){let t=this.getVisibleOptions();if(t.length!==0){if(this.selectedIndex>=0&&this.selectedIndex<t.length&&t[this.selectedIndex].classList.remove("fi-select-option-focused"),(this.selectedIndex===0||this.selectedIndex===-1)&&this.isSearchable&&this.searchInput){this.selectedIndex=-1,this.searchInput.focus();return}this.selectedIndex=(this.selectedIndex-1+t.length)%t.length,t[this.selectedIndex].classList.add("fi-select-option-focused"),t[this.selectedIndex].focus(),this.scrollOptionIntoView(t[this.selectedIndex])}}scrollOptionIntoView(t){if(!t)return;let e=this.dropdown.getBoundingClientRect(),s=t.getBoundingClientRect();s.bottom>e.bottom?this.dropdown.scrollTop+=s.bottom-e.bottom:s.top<e.top&&(this.dropdown.scrollTop-=e.top-s.top)}getVisibleOptions(){let t=Array.from(this.optionsList.querySelectorAll('li[role="option"]')),e=Array.from(this.optionsList.querySelectorAll('li > ul > li[role="option"]'));return[...t,...e]}getSelectedOptionLabels(){if(!Array.isArray(this.state)||this.state.length===0)return[];let t=[];if(Array.isArray(this.options)){for(let e of this.state)for(let s of this.options)if(s.options&&Array.isArray(s.options)){for(let n of s.options)if(n.value===e){t.push(n.label);break}}else if(s.value===e){t.push(s.label);break}}else if(typeof this.options=="object"&&this.options!==null)for(let e of this.state){if(this.options[e]&&typeof this.options[e]!="object"){t.push(this.options[e]);continue}let s=!1;for(let[n,o]of Object.entries(this.options))if(typeof o=="object"&&!Array.isArray(o)&&o!==null&&o[e]){t.push(o[e]),s=!0;break}s||t.push(e)}return t}handleSearch(t){let e=t.target.value.trim().toLowerCase();if(this.searchQuery=e,this.searchTimeout&&clearTimeout(this.searchTimeout),e===""){this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions();return}this.getSearchResultsUsing&&typeof this.getSearchResultsUsing=="function"&&this.hasDynamicSearchResults?this.searchTimeout=setTimeout(async()=>{try{this.showLoadingState(!0);let s=await this.getSearchResultsUsing(e);this.options=s,this.hideLoadingState(),this.renderOptions(),this.isOpen&&this.positionDropdown(),(Array.isArray(this.options)&&this.options.length===0||typeof this.options=="object"&&Object.keys(this.options).length===0)&&this.showNoResultsMessage()}catch(s){console.error("Error fetching search results:",s),this.hideLoadingState(),this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions()}},this.searchDebounce):this.filterOptions(e)}showLoadingState(t=!1){this.optionsList.innerHTML="";let e=document.createElement("li");e.className="fi-select-loading",e.textContent=t?this.searchingMessage:this.loadingMessage,this.optionsList.appendChild(e)}hideLoadingState(){let t=this.optionsList.querySelector(".fi-select-loading");t&&t.remove()}showNoResultsMessage(){this.optionsList.children.length>0&&(this.optionsList.innerHTML="");let t=document.createElement("li");t.className="fi-select-no-results",t.textContent=this.noSearchResultsMessage,this.optionsList.appendChild(t)}filterOptions(t){if(Array.isArray(this.originalOptions)){let e=[];for(let s of this.originalOptions)if(s.options&&Array.isArray(s.options)){let n=s.options.filter(o=>o.label.toLowerCase().includes(t));n.length>0&&e.push({label:s.label,options:n})}else s.label.toLowerCase().includes(t)&&e.push(s);this.options=e}else if(typeof this.originalOptions=="object"&&this.originalOptions!==null){let e={};for(let[s,n]of Object.entries(this.originalOptions))if(typeof n=="object"&&!Array.isArray(n)&&n!==null){let o={},r=!1;for(let[l,c]of Object.entries(n))String(c).toLowerCase().includes(t)&&(o[l]=c,r=!0);r&&(e[s]=o)}else String(n).toLowerCase().includes(t)&&(e[s]=n);this.options=e}this.renderOptions(),(Array.isArray(this.options)&&this.options.length===0||typeof this.options=="object"&&Object.keys(this.options).length===0)&&this.showNoResultsMessage(),this.isOpen&&this.positionDropdown()}selectOption(t){if(!this.isDisabled){if(this.isMultiple){let e=Array.isArray(this.state)?[...this.state]:[];if(e.includes(t))e=e.filter(s=>s!==t);else{if(this.maxItems&&e.length>=this.maxItems){this.maxItemsMessage&&alert(this.maxItemsMessage);return}e.push(t)}if(this.state=e,this.updateSelectedDisplay(),this.renderOptions(),this.isOpen&&this.positionDropdown(),this.isSearchable&&this.searchInput)this.searchInput.focus();else{let s=this.getVisibleOptions();if(s.length>0){if(this.selectedIndex=-1,Array.isArray(this.state)&&this.state.length>0){for(let n=0;n<s.length;n++)if(this.state.includes(s[n].getAttribute("data-value"))){this.selectedIndex=n;break}}this.selectedIndex===-1&&s.length>0&&(this.selectedIndex=0),this.selectedIndex>=0&&(s[this.selectedIndex].classList.add("fi-select-option-focused"),s[this.selectedIndex].focus())}}}else this.state=t,this.updateSelectedDisplay(),this.renderOptions(),this.closeDropdown(),this.selectButton.focus();this.onStateChange(this.state)}}disable(){this.isDisabled||(this.isDisabled=!0,this.applyDisabledState(),this.isOpen&&this.closeDropdown())}enable(){this.isDisabled&&(this.isDisabled=!1,this.applyDisabledState())}applyDisabledState(){if(this.isDisabled){if(this.selectButton.setAttribute("disabled","disabled"),this.selectButton.setAttribute("aria-disabled","true"),this.selectButton.classList.add("fi-select-disabled"),this.isMultiple&&this.container.querySelectorAll(".fi-select-badge-remove").forEach(e=>{e.setAttribute("disabled","disabled"),e.classList.add("fi-select-disabled")}),!this.isMultiple&&this.canSelectPlaceholder){let t=this.container.querySelector(".fi-select-single-remove");t&&(t.setAttribute("disabled","disabled"),t.classList.add("fi-select-disabled"))}this.isSearchable&&this.searchInput&&(this.searchInput.setAttribute("disabled","disabled"),this.searchInput.classList.add("fi-select-disabled"))}else{if(this.selectButton.removeAttribute("disabled"),this.selectButton.removeAttribute("aria-disabled"),this.selectButton.classList.remove("fi-select-disabled"),this.isMultiple&&this.container.querySelectorAll(".fi-select-badge-remove").forEach(e=>{e.removeAttribute("disabled"),e.classList.remove("fi-select-disabled")}),!this.isMultiple&&this.canSelectPlaceholder){let t=this.container.querySelector(".fi-select-single-remove");t&&(t.removeAttribute("disabled"),t.classList.remove("fi-select-disabled"))}this.isSearchable&&this.searchInput&&(this.searchInput.removeAttribute("disabled"),this.searchInput.classList.remove("fi-select-disabled"))}}};export{de as default};
