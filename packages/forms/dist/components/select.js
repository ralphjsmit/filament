var Y=Math.min,N=Math.max,G=Math.round;var C=i=>({x:i,y:i}),qt={left:"right",right:"left",bottom:"top",top:"bottom"},Jt={start:"end",end:"start"};function ht(i,t,e){return N(i,Y(t,e))}function X(i,t){return typeof i=="function"?i(t):i}function B(i){return i.split("-")[0]}function Q(i){return i.split("-")[1]}function ft(i){return i==="x"?"y":"x"}function ut(i){return i==="y"?"height":"width"}function F(i){return["top","bottom"].includes(B(i))?"y":"x"}function pt(i){return ft(F(i))}function xt(i,t,e){e===void 0&&(e=!1);let s=Q(i),n=pt(i),o=ut(n),r=n==="x"?s===(e?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(r=J(r)),[r,J(r)]}function vt(i){let t=J(i);return[nt(i),t,nt(t)]}function nt(i){return i.replace(/start|end/g,t=>Jt[t])}function Yt(i,t,e){let s=["left","right"],n=["right","left"],o=["top","bottom"],r=["bottom","top"];switch(i){case"top":case"bottom":return e?t?n:s:t?s:n;case"left":case"right":return t?o:r;default:return[]}}function Lt(i,t,e,s){let n=Q(i),o=Yt(B(i),e==="start",s);return n&&(o=o.map(r=>r+"-"+n),t&&(o=o.concat(o.map(nt)))),o}function J(i){return i.replace(/left|right|bottom|top/g,t=>qt[t])}function Gt(i){return{top:0,right:0,bottom:0,left:0,...i}}function Ot(i){return typeof i!="number"?Gt(i):{top:i,right:i,bottom:i,left:i}}function z(i){let{x:t,y:e,width:s,height:n}=i;return{width:s,height:n,top:e,left:t,right:t+s,bottom:e+n,x:t,y:e}}function At(i,t,e){let{reference:s,floating:n}=i,o=F(t),r=pt(t),l=ut(r),a=B(t),c=o==="y",d=s.x+s.width/2-n.width/2,h=s.y+s.height/2-n.height/2,u=s[l]/2-n[l]/2,f;switch(a){case"top":f={x:d,y:s.y-n.height};break;case"bottom":f={x:d,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:h};break;case"left":f={x:s.x-n.width,y:h};break;default:f={x:s.x,y:s.y}}switch(Q(t)){case"start":f[r]-=u*(e&&c?-1:1);break;case"end":f[r]+=u*(e&&c?-1:1);break}return f}var St=async(i,t,e)=>{let{placement:s="bottom",strategy:n="absolute",middleware:o=[],platform:r}=e,l=o.filter(Boolean),a=await(r.isRTL==null?void 0:r.isRTL(t)),c=await r.getElementRects({reference:i,floating:t,strategy:n}),{x:d,y:h}=At(c,s,a),u=s,f={},p=0;for(let m=0;m<l.length;m++){let{name:g,fn:w}=l[m],{x:b,y:x,data:v,reset:y}=await w({x:d,y:h,initialPlacement:s,placement:u,strategy:n,middlewareData:f,rects:c,platform:r,elements:{reference:i,floating:t}});d=b??d,h=x??h,f={...f,[g]:{...f[g],...v}},y&&p<=50&&(p++,typeof y=="object"&&(y.placement&&(u=y.placement),y.rects&&(c=y.rects===!0?await r.getElementRects({reference:i,floating:t,strategy:n}):y.rects),{x:d,y:h}=At(c,u,a)),m=-1)}return{x:d,y:h,placement:u,strategy:n,middlewareData:f}};async function mt(i,t){var e;t===void 0&&(t={});let{x:s,y:n,platform:o,rects:r,elements:l,strategy:a}=i,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:u=!1,padding:f=0}=X(t,i),p=Ot(f),g=l[u?h==="floating"?"reference":"floating":h],w=z(await o.getClippingRect({element:(e=await(o.isElement==null?void 0:o.isElement(g)))==null||e?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:c,rootBoundary:d,strategy:a})),b=h==="floating"?{x:s,y:n,width:r.floating.width,height:r.floating.height}:r.reference,x=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),v=await(o.isElement==null?void 0:o.isElement(x))?await(o.getScale==null?void 0:o.getScale(x))||{x:1,y:1}:{x:1,y:1},y=z(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:x,strategy:a}):b);return{top:(w.top-y.top+p.top)/v.y,bottom:(y.bottom-w.bottom+p.bottom)/v.y,left:(w.left-y.left+p.left)/v.x,right:(y.right-w.right+p.right)/v.x}}var Ct=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(t){var e,s;let{placement:n,middlewareData:o,rects:r,initialPlacement:l,platform:a,elements:c}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:u,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=X(i,t);if((e=o.arrow)!=null&&e.alignmentOffset)return{};let w=B(n),b=F(l),x=B(l)===l,v=await(a.isRTL==null?void 0:a.isRTL(c.floating)),y=u||(x||!m?[J(l)]:vt(l)),W=p!=="none";!u&&W&&y.push(...Lt(l,m,p,v));let j=[l,...y],H=await mt(t,g),k=[],S=((s=o.flip)==null?void 0:s.overflows)||[];if(d&&k.push(H[w]),h){let V=xt(n,r,v);k.push(H[V[0]],H[V[1]])}if(S=[...S,{placement:n,overflows:k}],!k.every(V=>V<=0)){var R,it;let V=(((R=o.flip)==null?void 0:R.index)||0)+1,dt=j[V];if(dt){var st;let M=h==="alignment"?b!==F(dt):!1,E=((st=S[0])==null?void 0:st.overflows[0])>0;if(!M||E)return{data:{index:V,overflows:S},reset:{placement:dt}}}let q=(it=S.filter(M=>M.overflows[0]<=0).sort((M,E)=>M.overflows[1]-E.overflows[1])[0])==null?void 0:it.placement;if(!q)switch(f){case"bestFit":{var yt;let M=(yt=S.filter(E=>{if(W){let P=F(E.placement);return P===b||P==="y"}return!0}).map(E=>[E.placement,E.overflows.filter(P=>P>0).reduce((P,jt)=>P+jt,0)]).sort((E,P)=>E[1]-P[1])[0])==null?void 0:yt[0];M&&(q=M);break}case"initialPlacement":q=l;break}if(n!==q)return{reset:{placement:q}}}return{}}}};async function Xt(i,t){let{placement:e,platform:s,elements:n}=i,o=await(s.isRTL==null?void 0:s.isRTL(n.floating)),r=B(e),l=Q(e),a=F(e)==="y",c=["left","top"].includes(r)?-1:1,d=o&&a?-1:1,h=X(t,i),{mainAxis:u,crossAxis:f,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof p=="number"&&(f=l==="end"?p*-1:p),a?{x:f*d,y:u*c}:{x:u*c,y:f*d}}var Dt=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(t){var e,s;let{x:n,y:o,placement:r,middlewareData:l}=t,a=await Xt(t,i);return r===((e=l.offset)==null?void 0:e.placement)&&(s=l.arrow)!=null&&s.alignmentOffset?{}:{x:n+a.x,y:o+a.y,data:{...a,placement:r}}}}},Et=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(t){let{x:e,y:s,placement:n}=t,{mainAxis:o=!0,crossAxis:r=!1,limiter:l={fn:g=>{let{x:w,y:b}=g;return{x:w,y:b}}},...a}=X(i,t),c={x:e,y:s},d=await mt(t,a),h=F(B(n)),u=ft(h),f=c[u],p=c[h];if(o){let g=u==="y"?"top":"left",w=u==="y"?"bottom":"right",b=f+d[g],x=f-d[w];f=ht(b,f,x)}if(r){let g=h==="y"?"top":"left",w=h==="y"?"bottom":"right",b=p+d[g],x=p-d[w];p=ht(b,p,x)}let m=l.fn({...t,[u]:f,[h]:p});return{...m,data:{x:m.x-e,y:m.y-s,enabled:{[u]:o,[h]:r}}}}}};function rt(){return typeof window<"u"}function $(i){return Rt(i)?(i.nodeName||"").toLowerCase():"#document"}function L(i){var t;return(i==null||(t=i.ownerDocument)==null?void 0:t.defaultView)||window}function I(i){var t;return(t=(Rt(i)?i.ownerDocument:i.document)||window.document)==null?void 0:t.documentElement}function Rt(i){return rt()?i instanceof Node||i instanceof L(i).Node:!1}function O(i){return rt()?i instanceof Element||i instanceof L(i).Element:!1}function D(i){return rt()?i instanceof HTMLElement||i instanceof L(i).HTMLElement:!1}function It(i){return!rt()||typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof L(i).ShadowRoot}function K(i){let{overflow:t,overflowX:e,overflowY:s,display:n}=A(i);return/auto|scroll|overlay|hidden|clip/.test(t+s+e)&&!["inline","contents"].includes(n)}function Tt(i){return["table","td","th"].includes($(i))}function Z(i){return[":popover-open",":modal"].some(t=>{try{return i.matches(t)}catch{return!1}})}function lt(i){let t=at(),e=O(i)?A(i):i;return["transform","translate","scale","rotate","perspective"].some(s=>e[s]?e[s]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(e.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(e.contain||"").includes(s))}function kt(i){let t=T(i);for(;D(t)&&!U(t);){if(lt(t))return t;if(Z(t))return null;t=T(t)}return null}function at(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function U(i){return["html","body","#document"].includes($(i))}function A(i){return L(i).getComputedStyle(i)}function tt(i){return O(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.scrollX,scrollTop:i.scrollY}}function T(i){if($(i)==="html")return i;let t=i.assignedSlot||i.parentNode||It(i)&&i.host||I(i);return It(t)?t.host:t}function Mt(i){let t=T(i);return U(t)?i.ownerDocument?i.ownerDocument.body:i.body:D(t)&&K(t)?t:Mt(t)}function ot(i,t,e){var s;t===void 0&&(t=[]),e===void 0&&(e=!0);let n=Mt(i),o=n===((s=i.ownerDocument)==null?void 0:s.body),r=L(n);if(o){let l=ct(r);return t.concat(r,r.visualViewport||[],K(n)?n:[],l&&e?ot(l):[])}return t.concat(n,ot(n,[],e))}function ct(i){return i.parent&&Object.getPrototypeOf(i.parent)?i.frameElement:null}function Bt(i){let t=A(i),e=parseFloat(t.width)||0,s=parseFloat(t.height)||0,n=D(i),o=n?i.offsetWidth:e,r=n?i.offsetHeight:s,l=G(e)!==o||G(s)!==r;return l&&(e=o,s=r),{width:e,height:s,$:l}}function Ft(i){return O(i)?i:i.contextElement}function _(i){let t=Ft(i);if(!D(t))return C(1);let e=t.getBoundingClientRect(),{width:s,height:n,$:o}=Bt(t),r=(o?G(e.width):e.width)/s,l=(o?G(e.height):e.height)/n;return(!r||!Number.isFinite(r))&&(r=1),(!l||!Number.isFinite(l))&&(l=1),{x:r,y:l}}var Qt=C(0);function Ht(i){let t=L(i);return!at()||!t.visualViewport?Qt:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Zt(i,t,e){return t===void 0&&(t=!1),!e||t&&e!==L(i)?!1:t}function et(i,t,e,s){t===void 0&&(t=!1),e===void 0&&(e=!1);let n=i.getBoundingClientRect(),o=Ft(i),r=C(1);t&&(s?O(s)&&(r=_(s)):r=_(i));let l=Zt(o,e,s)?Ht(o):C(0),a=(n.left+l.x)/r.x,c=(n.top+l.y)/r.y,d=n.width/r.x,h=n.height/r.y;if(o){let u=L(o),f=s&&O(s)?L(s):s,p=u,m=ct(p);for(;m&&s&&f!==p;){let g=_(m),w=m.getBoundingClientRect(),b=A(m),x=w.left+(m.clientLeft+parseFloat(b.paddingLeft))*g.x,v=w.top+(m.clientTop+parseFloat(b.paddingTop))*g.y;a*=g.x,c*=g.y,d*=g.x,h*=g.y,a+=x,c+=v,p=L(m),m=ct(p)}}return z({width:d,height:h,x:a,y:c})}function wt(i,t){let e=tt(i).scrollLeft;return t?t.left+e:et(I(i)).left+e}function Vt(i,t,e){e===void 0&&(e=!1);let s=i.getBoundingClientRect(),n=s.left+t.scrollLeft-(e?0:wt(i,s)),o=s.top+t.scrollTop;return{x:n,y:o}}function te(i){let{elements:t,rect:e,offsetParent:s,strategy:n}=i,o=n==="fixed",r=I(s),l=t?Z(t.floating):!1;if(s===r||l&&o)return e;let a={scrollLeft:0,scrollTop:0},c=C(1),d=C(0),h=D(s);if((h||!h&&!o)&&(($(s)!=="body"||K(r))&&(a=tt(s)),D(s))){let f=et(s);c=_(s),d.x=f.x+s.clientLeft,d.y=f.y+s.clientTop}let u=r&&!h&&!o?Vt(r,a,!0):C(0);return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-a.scrollLeft*c.x+d.x+u.x,y:e.y*c.y-a.scrollTop*c.y+d.y+u.y}}function ee(i){return Array.from(i.getClientRects())}function ie(i){let t=I(i),e=tt(i),s=i.ownerDocument.body,n=N(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),o=N(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight),r=-e.scrollLeft+wt(i),l=-e.scrollTop;return A(s).direction==="rtl"&&(r+=N(t.clientWidth,s.clientWidth)-n),{width:n,height:o,x:r,y:l}}function se(i,t){let e=L(i),s=I(i),n=e.visualViewport,o=s.clientWidth,r=s.clientHeight,l=0,a=0;if(n){o=n.width,r=n.height;let c=at();(!c||c&&t==="fixed")&&(l=n.offsetLeft,a=n.offsetTop)}return{width:o,height:r,x:l,y:a}}function ne(i,t){let e=et(i,!0,t==="fixed"),s=e.top+i.clientTop,n=e.left+i.clientLeft,o=D(i)?_(i):C(1),r=i.clientWidth*o.x,l=i.clientHeight*o.y,a=n*o.x,c=s*o.y;return{width:r,height:l,x:a,y:c}}function Pt(i,t,e){let s;if(t==="viewport")s=se(i,e);else if(t==="document")s=ie(I(i));else if(O(t))s=ne(t,e);else{let n=Ht(i);s={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return z(s)}function zt(i,t){let e=T(i);return e===t||!O(e)||U(e)?!1:A(e).position==="fixed"||zt(e,t)}function oe(i,t){let e=t.get(i);if(e)return e;let s=ot(i,[],!1).filter(l=>O(l)&&$(l)!=="body"),n=null,o=A(i).position==="fixed",r=o?T(i):i;for(;O(r)&&!U(r);){let l=A(r),a=lt(r);!a&&l.position==="fixed"&&(n=null),(o?!a&&!n:!a&&l.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||K(r)&&!a&&zt(i,r))?s=s.filter(d=>d!==r):n=l,r=T(r)}return t.set(i,s),s}function re(i){let{element:t,boundary:e,rootBoundary:s,strategy:n}=i,r=[...e==="clippingAncestors"?Z(t)?[]:oe(t,this._c):[].concat(e),s],l=r[0],a=r.reduce((c,d)=>{let h=Pt(t,d,n);return c.top=N(h.top,c.top),c.right=Y(h.right,c.right),c.bottom=Y(h.bottom,c.bottom),c.left=N(h.left,c.left),c},Pt(t,l,n));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function le(i){let{width:t,height:e}=Bt(i);return{width:t,height:e}}function ae(i,t,e){let s=D(t),n=I(t),o=e==="fixed",r=et(i,!0,o,t),l={scrollLeft:0,scrollTop:0},a=C(0);function c(){a.x=wt(n)}if(s||!s&&!o)if(($(t)!=="body"||K(n))&&(l=tt(t)),s){let f=et(t,!0,o,t);a.x=f.x+t.clientLeft,a.y=f.y+t.clientTop}else n&&c();o&&!s&&n&&c();let d=n&&!s&&!o?Vt(n,l):C(0),h=r.left+l.scrollLeft-a.x-d.x,u=r.top+l.scrollTop-a.y-d.y;return{x:h,y:u,width:r.width,height:r.height}}function gt(i){return A(i).position==="static"}function Nt(i,t){if(!D(i)||A(i).position==="fixed")return null;if(t)return t(i);let e=i.offsetParent;return I(i)===e&&(e=e.ownerDocument.body),e}function $t(i,t){let e=L(i);if(Z(i))return e;if(!D(i)){let n=T(i);for(;n&&!U(n);){if(O(n)&&!gt(n))return n;n=T(n)}return e}let s=Nt(i,t);for(;s&&Tt(s)&&gt(s);)s=Nt(s,t);return s&&U(s)&&gt(s)&&!lt(s)?e:s||kt(i)||e}var ce=async function(i){let t=this.getOffsetParent||$t,e=this.getDimensions,s=await e(i.floating);return{reference:ae(i.reference,await t(i.floating),i.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function de(i){return A(i).direction==="rtl"}var he={convertOffsetParentRelativeRectToViewportRelativeRect:te,getDocumentElement:I,getClippingRect:re,getOffsetParent:$t,getElementRects:ce,getClientRects:ee,getDimensions:le,getScale:_,isElement:O,isRTL:de};var Ut=Dt;var Wt=Et,Kt=Ct;var _t=(i,t,e)=>{let s=new Map,n={platform:he,...e},o={...n.platform,_c:s};return St(i,t,{...n,platform:o})};function fe({canSelectPlaceholder:i,isHtmlAllowed:t,getOptionLabelUsing:e,getOptionLabelsUsing:s,getOptionsUsing:n,getSearchResultsUsing:o,isAutofocused:r,isDisabled:l,isMultiple:a,isSearchable:c,hasDynamicOptions:d,hasDynamicSearchResults:h,livewireId:u,loadingMessage:f,maxItems:p,maxItemsMessage:m,noSearchResultsMessage:g,options:w,optionsLimit:b,placeholder:x,position:v,searchDebounce:y,searchingMessage:W,searchPrompt:j,searchableOptionFields:H,state:k,statePath:S}){return{state:k,select:null,init(){this.select=new bt({element:this.$refs.select,options:w,placeholder:x,state:this.state,canSelectPlaceholder:i,isHtmlAllowed:t,isAutofocused:r,isDisabled:l,isMultiple:a,isSearchable:c,getOptionLabelUsing:e,getOptionLabelsUsing:s,getOptionsUsing:n,getSearchResultsUsing:o,hasDynamicOptions:d,hasDynamicSearchResults:h,searchPrompt:j,searchDebounce:y,loadingMessage:f,searchingMessage:W,noSearchResultsMessage:g,maxItems:p,maxItemsMessage:m,optionsLimit:b,position:v,searchableOptionFields:H,livewireId:u,statePath:S,onStateChange:R=>{this.state=R}}),this.$watch("state",R=>{this.select&&this.select.state!==R&&(this.select.state=R,this.select.updateSelectedDisplay(),this.select.renderOptions())})},destroy(){this.select&&(this.select.destroy(),this.select=null)}}}var bt=class{constructor({element:t,options:e,placeholder:s,state:n,canSelectPlaceholder:o=!0,isHtmlAllowed:r=!1,isAutofocused:l=!1,isDisabled:a=!1,isMultiple:c=!1,isSearchable:d=!1,getOptionLabelUsing:h=null,getOptionLabelsUsing:u=null,getOptionsUsing:f=null,getSearchResultsUsing:p=null,hasDynamicOptions:m=!1,hasDynamicSearchResults:g=!0,searchPrompt:w="Search...",searchDebounce:b=1e3,loadingMessage:x="Loading...",searchingMessage:v="Searching...",noSearchResultsMessage:y="No results found",maxItems:W=null,maxItemsMessage:j="Maximum number of items selected",optionsLimit:H=null,position:k=null,searchableOptionFields:S=["label"],livewireId:R=null,statePath:it=null,onStateChange:st=()=>{}}){this.element=t,this.options=e,this.originalOptions=JSON.parse(JSON.stringify(e)),this.placeholder=s,this.state=n,this.canSelectPlaceholder=o,this.isHtmlAllowed=r,this.isAutofocused=l,this.isDisabled=a,this.isMultiple=c,this.isSearchable=d,this.getOptionLabelUsing=h,this.getOptionLabelsUsing=u,this.getOptionsUsing=f,this.getSearchResultsUsing=p,this.hasDynamicOptions=m,this.hasDynamicSearchResults=g,this.searchPrompt=w,this.searchDebounce=b,this.loadingMessage=x,this.searchingMessage=v,this.noSearchResultsMessage=y,this.maxItems=W,this.maxItemsMessage=j,this.optionsLimit=H,this.position=k,this.searchableOptionFields=Array.isArray(S)?S:["label"],this.livewireId=R,this.statePath=it,this.onStateChange=st,this.isOpen=!1,this.selectedIndex=-1,this.searchQuery="",this.searchTimeout=null,this.render(),this.setUpEventListeners(),this.isAutofocused&&this.selectButton.focus()}render(){this.container=document.createElement("div"),this.container.className="fi-fo-select-ctn",this.container.setAttribute("aria-haspopup","listbox"),this.selectButton=document.createElement("button"),this.selectButton.className="fi-fo-select-btn",this.selectButton.type="button",this.selectButton.setAttribute("aria-expanded","false"),this.selectedDisplay=document.createElement("span"),this.selectedDisplay.className="fi-fo-select-value-ctn",this.updateSelectedDisplay(),this.selectButton.appendChild(this.selectedDisplay),this.dropdown=document.createElement("div"),this.dropdown.className="fi-dropdown-panel fi-scrollable",this.dropdown.setAttribute("role","listbox"),this.dropdown.setAttribute("tabindex","-1"),this.dropdown.style.display="none",this.dropdownId=`fi-fo-select-dropdown-${Math.random().toString(36).substring(2,11)}`,this.dropdown.id=this.dropdownId,this.isMultiple&&this.dropdown.setAttribute("aria-multiselectable","true"),this.isSearchable&&(this.searchContainer=document.createElement("div"),this.searchContainer.className="fi-fo-select-search-ctn",this.searchInput=document.createElement("input"),this.searchInput.className="fi-input",this.searchInput.type="text",this.searchInput.placeholder=this.searchPrompt,this.searchInput.setAttribute("aria-label","Search"),this.searchContainer.appendChild(this.searchInput),this.dropdown.appendChild(this.searchContainer),this.searchInput.addEventListener("input",t=>{this.isDisabled||this.handleSearch(t)}),this.searchInput.addEventListener("keydown",t=>{if(!this.isDisabled){if(t.key==="Tab"){t.preventDefault();let e=this.getVisibleOptions();if(e.length===0)return;t.shiftKey?this.selectedIndex=e.length-1:this.selectedIndex=0,e.forEach(s=>{s.classList.remove("fi-selected")}),e[this.selectedIndex].classList.add("fi-selected"),e[this.selectedIndex].focus()}else if(t.key==="ArrowDown"){if(t.preventDefault(),t.stopPropagation(),this.getVisibleOptions().length===0)return;this.selectedIndex=-1,this.searchInput.blur(),this.focusNextOption()}else if(t.key==="ArrowUp"){t.preventDefault(),t.stopPropagation();let e=this.getVisibleOptions();if(e.length===0)return;this.selectedIndex=e.length-1,this.searchInput.blur(),e[this.selectedIndex].classList.add("fi-selected"),e[this.selectedIndex].focus(),e[this.selectedIndex].id&&this.dropdown.setAttribute("aria-activedescendant",e[this.selectedIndex].id),this.scrollOptionIntoView(e[this.selectedIndex])}}})),this.optionsList=document.createElement("ul"),this.renderOptions(),this.container.appendChild(this.selectButton),this.container.appendChild(this.dropdown),this.element.appendChild(this.container),this.applyDisabledState()}renderOptions(){this.optionsList.innerHTML="";let t=0,e=this.options,s=0,n=!1;this.options.forEach(l=>{l.options&&Array.isArray(l.options)?(s+=l.options.length,n=!0):s++}),n?this.optionsList.className="fi-fo-select-options-ctn":s>0&&(this.optionsList.className="fi-dropdown-list");let o=n?null:this.optionsList,r=0;for(let l of e){if(this.optionsLimit&&r>=this.optionsLimit)break;if(l.options&&Array.isArray(l.options)){let a=l.options;if(this.isMultiple&&Array.isArray(this.state)&&this.state.length>0&&(a=l.options.filter(c=>!this.state.includes(c.value))),a.length>0){if(this.optionsLimit){let c=this.optionsLimit-r;c<a.length&&(a=a.slice(0,c))}this.renderOptionGroup(l.label,a),r+=a.length,t+=a.length}}else{if(this.isMultiple&&Array.isArray(this.state)&&this.state.includes(l.value))continue;!o&&n&&(o=document.createElement("ul"),o.className="fi-dropdown-list",this.optionsList.appendChild(o));let a=this.createOptionElement(l.value,l);o.appendChild(a),r++,t++}}t===0?(this.searchQuery?this.showNoResultsMessage():this.isMultiple&&this.isOpen&&!this.isSearchable&&this.closeDropdown(),this.optionsList.parentNode===this.dropdown&&this.dropdown.removeChild(this.optionsList)):(this.hideLoadingState(),this.optionsList.parentNode!==this.dropdown&&this.dropdown.appendChild(this.optionsList))}renderOptionGroup(t,e){if(e.length===0)return;let s=document.createElement("li");s.className="fi-fo-select-option-group";let n=document.createElement("div");n.className="fi-dropdown-header",n.textContent=t;let o=document.createElement("ul");o.className="fi-dropdown-list",e.forEach(r=>{let l=this.createOptionElement(r.value,r);o.appendChild(l)}),s.appendChild(n),s.appendChild(o),this.optionsList.appendChild(s)}createOptionElement(t,e){let s=t,n=e,o=!1;typeof e=="object"&&e!==null&&"label"in e&&"value"in e&&(s=e.value,n=e.label,o=e.isDisabled||!1);let r=document.createElement("li");r.className="fi-dropdown-list-item fi-fo-select-option",o&&r.classList.add("fi-disabled");let l=`fi-fo-select-option-${Math.random().toString(36).substring(2,11)}`;if(r.id=l,r.setAttribute("role","option"),r.setAttribute("data-value",s),r.setAttribute("tabindex","0"),o&&r.setAttribute("aria-disabled","true"),this.isHtmlAllowed&&typeof n=="string"){let c=document.createElement("div");c.innerHTML=n;let d=c.textContent||c.innerText||n;r.setAttribute("aria-label",d)}let a=this.isMultiple?Array.isArray(this.state)&&this.state.includes(s):this.state===s;if(r.setAttribute("aria-selected",a?"true":"false"),a&&r.classList.add("fi-selected"),this.isHtmlAllowed){let c=document.createElement("span");c.innerHTML=n,r.appendChild(c)}else r.appendChild(document.createTextNode(n));return o||r.addEventListener("click",c=>{c.preventDefault(),c.stopPropagation(),this.selectOption(s),this.isMultiple&&(this.isSearchable&&this.searchInput?setTimeout(()=>{this.searchInput.focus()},0):setTimeout(()=>{r.focus()},0))}),r}async updateSelectedDisplay(){if(this.selectedDisplay.innerHTML="",this.isMultiple){if(!Array.isArray(this.state)||this.state.length===0){this.selectedDisplay.textContent=this.placeholder||"Select options";return}let e=await this.getLabelsForMultipleSelection();this.addBadgesForSelectedOptions(e);return}if(this.state===null||this.state===""){this.selectedDisplay.textContent=this.placeholder||"Select an option";return}let t=await this.getLabelForSingleSelection();this.addSingleSelectionDisplay(t)}async getLabelsForMultipleSelection(){let t=this.getSelectedOptionLabels();if(t.length<this.state.length&&this.getOptionLabelsUsing)try{let e=this.state.filter((s,n)=>!t[n]);if(e.length>0){let s=await this.getOptionLabelsUsing(e);return this.state.map(n=>{let o=this.getSelectedOptionLabel(n);return o||s[n]||n})}}catch(e){console.error("Error fetching option labels:",e)}return t}addBadgesForSelectedOptions(t){let e=document.createElement("div");e.className="fi-fo-select-value-badges-ctn",t.forEach((s,n)=>{let o=document.createElement("span");o.className="fi-badge fi-size-md fi-color fi-color-primary fi-text-color-600 dark:fi-text-color-200";let r=document.createElement("span");r.className="fi-badge-label-ctn";let l=document.createElement("span");l.className="fi-badge-label",this.isHtmlAllowed?l.innerHTML=s:l.textContent=s,r.appendChild(l),o.appendChild(r);let a=document.createElement("button");a.type="button",a.className="fi-badge-delete-btn",a.innerHTML='<svg class="fi-icon fi-size-xs" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',a.setAttribute("aria-label","Remove "+(this.isHtmlAllowed?s.replace(/<[^>]*>/g,""):s));let c=Array.isArray(this.state)?this.state[n]:null;a.addEventListener("click",d=>{d.stopPropagation(),c!==null&&this.selectOption(c)}),a.addEventListener("keydown",d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),d.stopPropagation(),c!==null&&this.selectOption(c))}),o.appendChild(a),e.appendChild(o)}),this.selectedDisplay.appendChild(e)}async getLabelForSingleSelection(){let t=this.getSelectedOptionLabel(this.state);if(!t&&this.getOptionLabelUsing)try{t=await this.getOptionLabelUsing(this.state)}catch(e){console.error("Error fetching option label:",e),t=this.state}else t||(t=this.state);return t}addSingleSelectionDisplay(t){let e=document.createElement("span");if(e.className="fi-fo-select-value-label",this.isHtmlAllowed?e.innerHTML=t:e.textContent=t,this.selectedDisplay.appendChild(e),!this.canSelectPlaceholder)return;let s=document.createElement("button");s.type="button",s.className="fi-fo-select-value-remove-btn",s.innerHTML='<svg class="fi-icon fi-size-sm" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>',s.setAttribute("aria-label","Clear selection"),s.addEventListener("click",n=>{n.stopPropagation(),this.selectOption("")}),s.addEventListener("keydown",n=>{(n.key===" "||n.key==="Enter")&&(n.preventDefault(),n.stopPropagation(),this.selectOption(""))}),this.selectedDisplay.appendChild(s)}getSelectedOptionLabel(t){let e="";for(let s of this.options)if(s.options&&Array.isArray(s.options)){for(let n of s.options)if(n.value===t){e=n.label;break}}else if(s.value===t){e=s.label;break}return e}setUpEventListeners(){this.buttonClickListener=()=>{this.toggleDropdown()},this.documentClickListener=t=>{!this.container.contains(t.target)&&this.isOpen&&this.closeDropdown()},this.buttonKeydownListener=t=>{this.isDisabled||this.handleSelectButtonKeydown(t)},this.dropdownKeydownListener=t=>{this.isDisabled||this.isSearchable&&document.activeElement===this.searchInput&&!["Tab","Escape"].includes(t.key)||this.handleDropdownKeydown(t)},this.selectButton.addEventListener("click",this.buttonClickListener),document.addEventListener("click",this.documentClickListener),this.selectButton.addEventListener("keydown",this.buttonKeydownListener),this.dropdown.addEventListener("keydown",this.dropdownKeydownListener),!this.isMultiple&&this.livewireId&&this.statePath&&this.getOptionLabelUsing&&(this.refreshOptionLabelListener=async t=>{if(t.detail.livewireId===this.livewireId&&t.detail.statePath===this.statePath&&this.state!==null&&this.state!=="")try{let e=await this.getOptionLabelUsing(this.state),s=this.selectedDisplay.querySelector(".fi-fo-select-value-label");s&&(this.isHtmlAllowed?s.innerHTML=e:s.textContent=e),this.updateOptionLabelInList(this.state,e)}catch(e){console.error("Error refreshing option label:",e)}},window.addEventListener("filament-forms::select.refreshSelectedOptionLabel",this.refreshOptionLabelListener))}updateOptionLabelInList(t,e){let s=this.getVisibleOptions();for(let n of s)if(n.getAttribute("data-value")===String(t)){if(n.innerHTML="",this.isHtmlAllowed){let o=document.createElement("span");o.innerHTML=e,n.appendChild(o)}else n.appendChild(document.createTextNode(e));break}for(let n of this.options)if(n.options&&Array.isArray(n.options)){for(let o of n.options)if(o.value===t){o.label=e;break}}else if(n.value===t){n.label=e;break}for(let n of this.originalOptions)if(n.options&&Array.isArray(n.options)){for(let o of n.options)if(o.value===t){o.label=e;break}}else if(n.value===t){n.label=e;break}}handleSelectButtonKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),t.stopPropagation(),this.isOpen?this.focusNextOption():this.openDropdown();break;case"ArrowUp":t.preventDefault(),t.stopPropagation(),this.isOpen?this.focusPreviousOption():this.openDropdown();break;case" ":if(t.preventDefault(),this.isOpen){if(this.selectedIndex>=0){let e=this.getVisibleOptions()[this.selectedIndex];e&&e.click()}}else this.openDropdown();break;case"Enter":break;case"Escape":this.isOpen&&(t.preventDefault(),this.closeDropdown());break;case"Tab":this.isOpen&&this.closeDropdown();break}}handleDropdownKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),t.stopPropagation(),this.focusNextOption();break;case"ArrowUp":t.preventDefault(),t.stopPropagation(),this.focusPreviousOption();break;case" ":if(t.preventDefault(),this.selectedIndex>=0){let e=this.getVisibleOptions()[this.selectedIndex];e&&e.click()}break;case"Enter":if(t.preventDefault(),this.selectedIndex>=0){let e=this.getVisibleOptions()[this.selectedIndex];e&&e.click()}else{let e=this.element.closest("form");e&&e.submit()}break;case"Escape":t.preventDefault(),this.closeDropdown(),this.selectButton.focus();break;case"Tab":this.closeDropdown();break}}toggleDropdown(){if(!this.isDisabled){if(this.isOpen){this.closeDropdown();return}this.isMultiple&&!this.isSearchable&&!this.hasAvailableOptions()||this.openDropdown()}}hasAvailableOptions(){for(let t of this.options)if(t.options&&Array.isArray(t.options)){for(let e of t.options)if(!Array.isArray(this.state)||!this.state.includes(e.value))return!0}else if(!Array.isArray(this.state)||!this.state.includes(t.value))return!0;return!1}async openDropdown(){if(this.dropdown.style.display="block",this.dropdown.style.opacity="0",this.dropdown.style.position="absolute",this.selectButton.setAttribute("aria-expanded","true"),this.isOpen=!0,this.positionDropdown(),this.resizeListener||(this.resizeListener=()=>this.positionDropdown(),window.addEventListener("resize",this.resizeListener)),this.dropdown.style.opacity="1",this.hasDynamicOptions&&this.getOptionsUsing){this.showLoadingState(!1);try{let t=await this.getOptionsUsing();this.options=t,this.originalOptions=JSON.parse(JSON.stringify(t)),this.renderOptions()}catch(t){console.error("Error fetching options:",t),this.hideLoadingState()}}if(this.hideLoadingState(),this.isSearchable&&this.searchInput)this.searchInput.value="",this.searchInput.focus(),this.searchQuery="",this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions();else{this.selectedIndex=-1;let t=this.getVisibleOptions();if(this.isMultiple){if(Array.isArray(this.state)&&this.state.length>0){for(let e=0;e<t.length;e++)if(this.state.includes(t[e].getAttribute("data-value"))){this.selectedIndex=e;break}}}else for(let e=0;e<t.length;e++)if(t[e].getAttribute("data-value")===this.state){this.selectedIndex=e;break}this.selectedIndex===-1&&t.length>0&&(this.selectedIndex=0),this.selectedIndex>=0&&(t[this.selectedIndex].classList.add("fi-selected"),t[this.selectedIndex].focus())}}positionDropdown(){let t=this.position==="top"?"top-start":"bottom-start",e=[Ut(4),Wt({padding:5})];this.position!=="top"&&this.position!=="bottom"&&e.push(Kt()),_t(this.selectButton,this.dropdown,{placement:t,middleware:e}).then(({x:s,y:n})=>{Object.assign(this.dropdown.style,{left:`${s}px`,top:`${n}px`,width:`${this.selectButton.offsetWidth}px`})})}closeDropdown(){this.dropdown.style.display="none",this.selectButton.setAttribute("aria-expanded","false"),this.isOpen=!1,this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null),this.getVisibleOptions().forEach(e=>{e.classList.remove("fi-selected")})}focusNextOption(){let t=this.getVisibleOptions();if(t.length!==0){if(this.selectedIndex>=0&&this.selectedIndex<t.length&&t[this.selectedIndex].classList.remove("fi-selected"),this.selectedIndex===t.length-1&&this.isSearchable&&this.searchInput){this.selectedIndex=-1,this.searchInput.focus(),this.dropdown.removeAttribute("aria-activedescendant");return}this.selectedIndex=(this.selectedIndex+1)%t.length,t[this.selectedIndex].classList.add("fi-selected"),t[this.selectedIndex].focus(),t[this.selectedIndex].id&&this.dropdown.setAttribute("aria-activedescendant",t[this.selectedIndex].id),this.scrollOptionIntoView(t[this.selectedIndex])}}focusPreviousOption(){let t=this.getVisibleOptions();if(t.length!==0){if(this.selectedIndex>=0&&this.selectedIndex<t.length&&t[this.selectedIndex].classList.remove("fi-selected"),(this.selectedIndex===0||this.selectedIndex===-1)&&this.isSearchable&&this.searchInput){this.selectedIndex=-1,this.searchInput.focus(),this.dropdown.removeAttribute("aria-activedescendant");return}this.selectedIndex=(this.selectedIndex-1+t.length)%t.length,t[this.selectedIndex].classList.add("fi-selected"),t[this.selectedIndex].focus(),t[this.selectedIndex].id&&this.dropdown.setAttribute("aria-activedescendant",t[this.selectedIndex].id),this.scrollOptionIntoView(t[this.selectedIndex])}}scrollOptionIntoView(t){if(!t)return;let e=this.dropdown.getBoundingClientRect(),s=t.getBoundingClientRect();s.bottom>e.bottom?this.dropdown.scrollTop+=s.bottom-e.bottom:s.top<e.top&&(this.dropdown.scrollTop-=e.top-s.top)}getVisibleOptions(){let t=[];this.optionsList.classList.contains("fi-dropdown-list")?t=Array.from(this.optionsList.querySelectorAll(':scope > li[role="option"]')):t=Array.from(this.optionsList.querySelectorAll(':scope > ul.fi-dropdown-list > li[role="option"]'));let e=Array.from(this.optionsList.querySelectorAll('li.fi-fo-select-option-group > ul > li[role="option"]'));return[...t,...e]}getSelectedOptionLabels(){if(!Array.isArray(this.state)||this.state.length===0)return[];let t=[];for(let e of this.state){let s=!1;for(let n of this.options)if(n.options&&Array.isArray(n.options)){for(let o of n.options)if(o.value===e){t.push(o.label),s=!0;break}if(s)break}else if(n.value===e){t.push(n.label),s=!0;break}s||t.push(e)}return t}handleSearch(t){let e=t.target.value.trim().toLowerCase();if(this.searchQuery=e,this.searchTimeout&&clearTimeout(this.searchTimeout),e===""){this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions();return}if(!this.getSearchResultsUsing||typeof this.getSearchResultsUsing!="function"||!this.hasDynamicSearchResults){this.filterOptions(e);return}this.searchTimeout=setTimeout(async()=>{try{this.showLoadingState(!0);let s=await this.getSearchResultsUsing(e);this.options=s,this.hideLoadingState(),this.renderOptions(),this.isOpen&&this.positionDropdown(),this.options.length===0&&this.showNoResultsMessage()}catch(s){console.error("Error fetching search results:",s),this.hideLoadingState(),this.options=JSON.parse(JSON.stringify(this.originalOptions)),this.renderOptions()}},this.searchDebounce)}showLoadingState(t=!1){this.optionsList.parentNode===this.dropdown&&(this.optionsList.innerHTML=""),this.hideLoadingState();let e=document.createElement("div");e.className="fi-fo-select-message",e.textContent=t?this.searchingMessage:this.loadingMessage,this.dropdown.appendChild(e)}hideLoadingState(){let t=this.dropdown.querySelector(".fi-fo-select-message");t&&t.remove()}showNoResultsMessage(){this.optionsList.parentNode===this.dropdown&&this.optionsList.children.length>0&&(this.optionsList.innerHTML=""),this.hideLoadingState();let t=document.createElement("div");t.className="fi-fo-select-message",t.textContent=this.noSearchResultsMessage,this.dropdown.appendChild(t)}filterOptions(t){let e=this.searchableOptionFields.includes("label"),s=this.searchableOptionFields.includes("value"),n=[];for(let o of this.originalOptions)if(o.options&&Array.isArray(o.options)){let r=o.options.filter(l=>e&&l.label.toLowerCase().includes(t)||s&&String(l.value).toLowerCase().includes(t));r.length>0&&n.push({label:o.label,options:r})}else(e&&o.label.toLowerCase().includes(t)||s&&String(o.value).toLowerCase().includes(t))&&n.push(o);this.options=n,this.renderOptions(),this.options.length===0&&this.showNoResultsMessage(),this.isOpen&&this.positionDropdown()}selectOption(t){if(this.isDisabled)return;if(!this.isMultiple){this.state=t,this.updateSelectedDisplay(),this.renderOptions(),this.closeDropdown(),this.selectButton.focus(),this.onStateChange(this.state);return}let e=Array.isArray(this.state)?[...this.state]:[];if(e.includes(t)){e=e.filter(s=>s!==t),this.state=e,this.updateSelectedDisplay(),this.renderOptions(),this.isOpen&&this.positionDropdown(),this.maintainFocusInMultipleMode(),this.onStateChange(this.state);return}if(this.maxItems&&e.length>=this.maxItems){this.maxItemsMessage&&alert(this.maxItemsMessage);return}e.push(t),this.state=e,this.updateSelectedDisplay(),this.renderOptions(),this.isOpen&&this.positionDropdown(),this.maintainFocusInMultipleMode(),this.onStateChange(this.state)}maintainFocusInMultipleMode(){if(this.isSearchable&&this.searchInput){this.searchInput.focus();return}let t=this.getVisibleOptions();if(t.length!==0){if(this.selectedIndex=-1,Array.isArray(this.state)&&this.state.length>0){for(let e=0;e<t.length;e++)if(this.state.includes(t[e].getAttribute("data-value"))){this.selectedIndex=e;break}}this.selectedIndex===-1&&(this.selectedIndex=0),t[this.selectedIndex].classList.add("fi-selected"),t[this.selectedIndex].focus()}}disable(){this.isDisabled||(this.isDisabled=!0,this.applyDisabledState(),this.isOpen&&this.closeDropdown())}enable(){this.isDisabled&&(this.isDisabled=!1,this.applyDisabledState())}applyDisabledState(){if(this.isDisabled){if(this.selectButton.setAttribute("disabled","disabled"),this.selectButton.setAttribute("aria-disabled","true"),this.selectButton.classList.add("fi-disabled"),this.isMultiple&&this.container.querySelectorAll(".fi-fo-select-badge-remove").forEach(e=>{e.setAttribute("disabled","disabled"),e.classList.add("fi-disabled")}),!this.isMultiple&&this.canSelectPlaceholder){let t=this.container.querySelector(".fi-fo-select-value-remove-btn");t&&(t.setAttribute("disabled","disabled"),t.classList.add("fi-disabled"))}this.isSearchable&&this.searchInput&&(this.searchInput.setAttribute("disabled","disabled"),this.searchInput.classList.add("fi-disabled"))}else{if(this.selectButton.removeAttribute("disabled"),this.selectButton.removeAttribute("aria-disabled"),this.selectButton.classList.remove("fi-disabled"),this.isMultiple&&this.container.querySelectorAll(".fi-fo-select-badge-remove").forEach(e=>{e.removeAttribute("disabled"),e.classList.remove("fi-disabled")}),!this.isMultiple&&this.canSelectPlaceholder){let t=this.container.querySelector(".fi-fo-select-value-remove-btn");t&&(t.removeAttribute("disabled"),t.classList.add("fi-disabled"))}this.isSearchable&&this.searchInput&&(this.searchInput.removeAttribute("disabled"),this.searchInput.classList.remove("fi-disabled"))}}destroy(){this.selectButton&&this.buttonClickListener&&this.selectButton.removeEventListener("click",this.buttonClickListener),this.documentClickListener&&document.removeEventListener("click",this.documentClickListener),this.selectButton&&this.buttonKeydownListener&&this.selectButton.removeEventListener("keydown",this.buttonKeydownListener),this.dropdown&&this.dropdownKeydownListener&&this.dropdown.removeEventListener("keydown",this.dropdownKeydownListener),this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null),this.refreshOptionLabelListener&&window.removeEventListener("filament-forms::select.refreshSelectedOptionLabel",this.refreshOptionLabelListener),this.isOpen&&this.closeDropdown(),this.searchTimeout&&(clearTimeout(this.searchTimeout),this.searchTimeout=null)}};export{fe as default};
